<h1>Posts#index</h1>
<section id="new_post">
  <div>
    <%= form_with model: @new_post do |form| %>
      <div class="field">
        <%= form.label :body %>
        <%= form.text_area :body %>
      </div>
      <%= form.submit "Create Post" %>
    <% end %>
  </div>
</section>

<section id="posts">
  <div>
    <% @posts.each do |post| %>
      <div>
        <h4><%= post.user.email %></h4>
        <div>
          <p>
            <%= post.body %>
          </p>
        </div>
        <div>
          <p>Comments: <%= post.comments.length %></p>
          <p>Likes: <%= post.likes_counter %></p>
        </div>
        <div>
          <% post.comments.each do |comment| %>
            <div>
              <p><%= comment.body %></p>
            </div>
          <% end %>
        </div>
        <div>
          <%= form_with model: @new_comment do |form| %>
            <%= form.hidden_field :commentable_id, value: post.id %>
            <%= form.hidden_field :commentable_type, value: "Post" %>
            <div class="field">
              <%= form.label :body %>
              <%= form.text_field :body %>
            </div>
            <div>
              <%= button_to "like", likes_path, params: {likeable_type: "Post", likeable_id: post.id} %>
              <%= form.submit "leave a comment" %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</section>
